# DC Analytics Service Backend

DC Analytics Service Backend – это REST API, разработанный на Go для обработки аналитических данных. Проект использует чистую архитектуру с разделением логики по слоям (Handler → Service → Repository) и интегрирован с базами данных PostgreSQL и ClickHouse, а также имеет поддержку авторизации JWT и Swagger-документацию.

- [Особенности](#особенности)
- [Установка и запуск](#установка-и-запуск)
- [Документация Swagger](#документация-swagger)
- [Требования](#требования)

## Особенности

- **REST API** для управления пользователями, устройствами, аналитикой звонков и вебхуками.
- **Разделение логики** на три слоя:
    - **Handler:** обработка HTTP-запросов и формирование ответов.
    - **Service:** реализация бизнес-логики и валидация данных.
    - **Repository:** запросы к базам данных и работа с SQL.
- **Интеграция с двумя СУБД:**
    - **PostgreSQL** для оперативных данных.
    - **ClickHouse** для аналитики.
- **JWT-авторизация** для защиты эндпоинтов.
- **Swagger-документация** для удобного ознакомления с API.
- **Пагинация** для выборки данных.
- **Graceful Shutdown** для корректного завершения работы и освобождения ресурсов.

## Документация Swagger
Проект включает полноценную документацию API, которая сгенерирована с использованием [swaggo/swag](https://github.com/swaggo/swag). Документация позволяет легко просмотреть все доступные эндпоинты, их параметры, примеры запросов и ответов.
```bash
http://host:port/swagger/index.html
```
## Установка и запуск

### 1. Клонируйте репозиторий:

```bash
git clone https://bitbucket.org/cyberzion_jsa/dc-analytics-service-backend
cd dc-analytics-service-backend
```
### 2. Настройте переменные окружения
| Переменная           | Описание                                  | 
|----------------------|-------------------------------------------|
| `PORT`               | Порт сервера                              | 
| `JWT_SECRET`         | Секрет для генерации JWT                  | 
| `LOG_LEVEL`          | Уровень логирования                       | 
| `POSTGRES_DSN`       | Строка подключения к PostgreSQL           | 
| `CLICKHOUSE_HOST`    | Хост для ClickHouse                       | 
| `CLICKHOUSE_DB`      | База данных ClickHouse                    | 
| `CLICKHOUSE_USERNAME`| Пользователь для ClickHouse               |
| `CLICKHOUSE_PASSWORD`| Пароль для ClickHouse                     | 
| `CLICKHOUSE_DEBUG`   | Режим отладки для ClickHouse              | 

### Запуск
```bash
go run cmd/main.go
```
## Требования
- Go 1.23+
- PostgreSQL
- ClickHouse 

